---
title: "Project Part 2"
format: html
editor: source
self-contained: true
---

```{r}
#| label: load in data & libraries

library(readr)
library(tidyverse)
library(lme4)
library(nlme)
library(performance)
library(ggplot2)

df_baseball <- read_csv("https://www.dropbox.com/scl/fi/2bcvc8eabdinum2e3r9oj/statcast_pitch_swing_data_20240402_20240630.csv?rlkey=bl9kxe5o9yv017cmjssbgya3s&st=pnrx2dej&dl=1")
```


```{r}
#| label: clean data

# only keep variables of interest, drop NA obs.
df_baseball_clean <- df_baseball |>
  mutate(dist_from_cen = sqrt(hc_x^2 + hc_y^2)) |>
  select(hit_distance_sc, pitch_type, dist_from_cen, launch_angle, launch_speed, game_type, batter) |>
  drop_na() |>
  mutate(dist_from_cen_gmc = dist_from_cen - mean(dist_from_cen),
         hit_distance_gmc = hit_distance_sc - mean(hit_distance_sc),
         launch_angle_gmc = launch_angle - mean(launch_angle),
         launch_speed_gmc = launch_speed - mean(launch_speed))

```

```{r}
#| label: EDA on variables of interest

df_baseball_clean
```

```{r}
modelpt <-  lm(hit_distance_sc ~ pitch_type, data = df_baseball_clean)
summary(modelpt)

plot(modelpt)

```

```{r}
modeldfg <- lm(hit_distance_sc ~ dist_from_cen_gmc, data = df_baseball_clean)
summary(modeldfg)

plot(modeldfg)

```

```{r}
modellag <- lm(hit_distance_sc ~ launch_angle_gmc, data = df_baseball_clean)
summary(modellag)

plot(modellag)
```

```{r}
modellsg <- lm(hit_distance_sc ~ launch_speed_gmc, data = df_baseball_clean)
summary(modellsg)

plot(modellsg)
```



